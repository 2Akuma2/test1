<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="6.0.3">
<link rel="shortcut icon" href="../icons/favicon.ico" type="image/vnd.microsoft.icon">
<title>Testausf&uuml;hrung im Batchmodus</title>
<link href="man.css" type="text/css" rel="stylesheet">
<meta name="organisation" content="Quality First Software GmbH">
<meta name="copyright" content="(C) 1999-2022 Quality First Software GmbH">
</head>
<body bgcolor="white">
<a name="usec_execbatch"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="naviheader">
<tr>
<td class="margin"></td><td class="navicon"><a href="manual.html"><img src="../icons/linktop.png" width="34" height="36" border="0" alt="Top" title="Top"></a></td><td class="navicon"><a href="contents.html#table-of-contents"><img src="../icons/linktoc.png" width="34" height="36" border="0" alt="Inhaltsverzeichnis" title="Inhaltsverzeichnis"></a></td><td class="navicon"><img src="../icons/linkprevdis.png" width="34" height="36" alt="" border="0"></td><td class="navicon"><a href="user_execdaemon.html#usec_execdaemon"><img src="../icons/linkcont.png" width="34" height="36" border="0" alt="N&auml;chste Seite: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus" title="N&auml;chste Seite: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus"></a></td><td class="navicon"><a href="user_execdaemon.html#usec_execdaemon"><img src="../icons/linknext.png" width="34" height="36" border="0" alt="N&auml;chstes Kapitel: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus" title="N&auml;chstes Kapitel: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus"></a></td><td class="navicon"><a href="user_testexecution.html#usec_testexecution"><img src="../icons/linkup.png" width="34" height="36" border="0" alt="Kapitel-&Uuml;bersicht: 22&nbsp;Testausf&uuml;hrung" title="Kapitel-&Uuml;bersicht: 22&nbsp;Testausf&uuml;hrung"></a></td><td class="navicon"><a href="../../manual_de.pdf" target="_parent"><img src="../icons/linkpdf.png" width="34" height="36" border="0" alt="PDF Version" title="PDF Version"></a></td><td class="homeicon"><a href="http://www.qfs.de/de/qftest/index.html" target="_parent"><img src="../icons/qftest.png" width="127" height="42" border="0" alt="QF-Test" title="QF-Test"></a></td>
</tr>
</table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="naviversion">
<tr>
<td>Version 6.0.3</td>
</tr>
</table>
      
<h4 class="header-container h4">
<div>
<span class="numtitle"><a href="contents.html#toc_usec_execbatch">22.1</a></span>
</div>
<a href="contents.html#toc_usec_execbatch">Testausf&uuml;hrung im Batchmodus</a>
</h4>
      

      
<p>
        Grundlage f&uuml;r die Ausf&uuml;hrung von Tests &uuml;ber die Kommandozeile bildet eine Vielzahl von
        Argumenten, mit denen QF-Test im Batchmodus gestartet werden kann. Anschlie&szlig;end werden
        exemplarisch einige davon behandelt; eine &Uuml;bersicht &uuml;ber alle Optionen findet man in
        <a href="tech_execution.html#sec_execution">Kapitel 40</a>.
      </p>
      
<p>
        Die nachfolgenden Beispiele sind f&uuml;r Windows geschrieben, lassen sich aber leicht auf
        Linux &uuml;bertragen. Neben den Pfadangaben unterscheidet sich die Syntax nur noch im Bezug
        auf die Platzhalter (<a href="tech_execution.html#sec_placeholders">Abschnitt 40.2.4</a>): Unter Linux kann neben der Form
        +X auch %X verwendet werden. Unter Windows gibt es au&szlig;erdem neben der GUI-Anwendung
        <code>qftest.exe</code> auch eine Konsolen-Variante <code>qftestc.exe</code>. Diese
        wartet, bis die Ausf&uuml;hrung von QF-Test beendet ist und gibt u. a. auch print-Ausgaben von
        einem <a href="control.html#step_ServerScriptStep" shape="rect">'Server Skript'</a> aus.
      </p>

      
      

      
<a name="sec_N90220"></a>
        
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_N90220">22.1.1</a></span>
</div>
<a href="contents.html#toc_sec_N90220">Verwenden der Kommandozeile</a>
</h5>

        
<p>
          Der einfachste Aufruf von QF-Test, um einen Test auszuf&uuml;hren, sieht so aus:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>qftest -batch -run c:\mysuites\suiteA.qft</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.1:&nbsp;&nbsp;Testausf&uuml;hrung von der Kommandozeile</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Das Argument <code>-batch</code> sorgt daf&uuml;r, dass QF-Test ohne graphische
          Benutzeroberfl&auml;che gestartet wird. Das zweite Argument, <code>-run</code>, sagt QF-Test,
          dass ein Test ausgef&uuml;hrt werden soll. Den Abschluss der Kommandozeile bildet die
          auszuf&uuml;hrende Testsuite.
        </p>
        
<p>
          
<span class="margin"><span class="note">Hinweis</span></span> Das Argument <code>-run</code> ist optional, d. h. die
          Testausf&uuml;hrung ist als Standard f&uuml;r den Batchmodus definiert.
        </p>
        
<p>
          F&uuml;hrt man die obige Anweisung aus, werden alle 'Testfall' und
          'Testfallsatz' Knoten nacheinander ausgef&uuml;hrt, die in der Testsuite
          <code>suiteA.qft</code> auf der obersten Ebene (d. h. direkt unterhalb des
          'Testsuite' Knotens) definiert sind. Nach Beendigung des Testlaufs findet man im
          aktuellen Verzeichnis, unter dem gleichen Namen wie die Testsuite, eine
          Protokolldatei, der man das Testergebnis entnehmen kann.
        </p>
        
<p>
          Durch Angabe von <code>-nolog</code> kann die Erstellung der Protokolldatei auch
          unterdr&uuml;ckt werden. Das macht aber wahrscheinlich nur dann Sinn, wenn man seinen Test
          um eigene Protokollausgaben bereichert hat, die etwas in eine Datei geschrieben werden.
          Ansonsten lieferte nur noch der R&uuml;ckgabewert von QF-Test einen Hinweis auf den Ausgang
          des Testlaufs: 0 bedeutet, dass der Test erfolgreich absolviert wurde, ein positiver
          Wert hingegen ist die Folge von Warnungen, Fehlern oder gar Exceptions (siehe <a href="tech_execution.html#sec_exitcodes">Abschnitt 40.3</a>).
        </p>
        
<p>
          In der Regel m&ouml;chte man also wohl ein Protokoll des Testlaufs erstellen und dieses an
          einer bestimmten Stelle im Dateisystem ablegen. Das geht &uuml;ber den Parameter
          <code>-runlog</code>:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>qftest -batch -compact -runlog c:\mylogs\+b c:\mysuites\suiteA.qft</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.2:&nbsp;&nbsp;Testausf&uuml;hrung mit Protokolldatei</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Nun wird eine Protokolldatei <code>suiteA.qrz</code> im angegebenen Verzeichnis
          <code>c:\mylogs</code> erstellt. Der Platzhalter <code>+b</code> sorgt daf&uuml;r, dass sie
          den Namen von der Testsuite &uuml;bernimmt. Durch die Angabe von <code>-compact</code> wird
          erreicht, dass nur die wichtigsten Knoten in die Protokolldatei &uuml;bernommen werden,
          also nur solche, die f&uuml;r den Report und gegebenenfalls die Fehleranalyse ben&ouml;tigt
          werden. Bei sehr umfangreichen Tests kann dieser Parameter helfen, den
          Anspruch an Arbeitsspeicher in Grenzen zu halten, wobei die neuere M&ouml;glichkeit,
          Protokolldateien zu splitten, sogar noch m&auml;chtiger ist. N&auml;here Informationen dazu finden Sie in
          <a href="user_debugging.html#usec_runlog">Abschnitt 7.1</a>.
        </p>
        
<p>
          
<span class="margin"><span class="note">Hinweis</span></span> Ob die Datei hier tats&auml;chlich als komprimiertes Protokoll
          (das ist vom obigen "compact" zu unterscheiden) mit der Endung <code>.qrz</code>
          erstellt wird, h&auml;ngt von den Einstellungen ab. Um ein bestimmtes Format zu erzwingen,
          kann die Endung explizit angegeben werden, also z. B. <code>-runlog
          c:\mylogs\+b.qrl</code>, wenn unkomprimiertes XML gew&uuml;nscht wird.
        </p>
        
<p>
          Manchmal m&ouml;chte man vielleicht nicht die komplette Testsuite, sondern nur bestimmte
          Testf&auml;lle ausf&uuml;hren. &Uuml;ber den Parameter <code>-test</code> l&auml;sst sich ein ganz
          bestimmter Knoten zur Ausf&uuml;hrung festlegen:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>qftest -batch -runlog c:\mylogs\+b -test "Mein Test" c:\mysuites\suiteA.qft</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.3:&nbsp;&nbsp;Ausf&uuml;hrung eines bestimmten Knotens</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Die Angabe <code>"Mein Test"</code> bezieht sich dabei auf das Attribut 'QF-Test ID' des
          auszuf&uuml;hrenden Knotens; bei 'Testfall' oder 'Testfallsatz' Knoten kann auch deren
          qualifizierter Name angegeben werden. Sollen mehrere Knoten ausgef&uuml;hrt werden, kann
          das Argument <code>-test &lt;ID&gt;</code> auch mehrfach angegeben werden. Neben der
          QF-Test ID eines Knotens versteht <code>-test</code> auch die Angabe eines numerischen Index. So
          w&uuml;rde etwa <code>-test 0</code> den ersten Knoten unterhalb von 'Testsuite'
          ausf&uuml;hren.
        </p>
        
<p>
          Das Protokoll liefert eine eher technische Sicht auf den Ablauf eines Tests; es ist
          vor allem n&uuml;tzlich, um w&auml;hrend eines Testlaufs aufgetretene Fehler zu analysieren
          (vgl. <a href="user_debugging.html#usec_runlog">Abschnitt 7.1</a>). Eine &uuml;bersichtliche Darstellung &uuml;ber die
          ausgef&uuml;hrten Testf&auml;lle und eventuell aufgetretene Fehler bietet hingegen der Report.
          Er wird aus der Protokolldatei erstellt und liegt anschlie&szlig;end im XML- und/oder
          HTML-Format vor. Der Report kann also auch nachtr&auml;glich aus einer (oder mehreren)
          Protokolldateien erstellt werden (vgl. <a href="user_report.html#usec_report">Kapitel 21</a>). Um gleich bei
          der Testausf&uuml;hrung daf&uuml;r zu sorgen, verwendet man <code>-report</code>:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>qftest -batch -runlog c:\mylogs\+b -report c:\mylogs\rep_+b_+y+M+d+h+m c:\mysuites\suiteA.qft</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.4:&nbsp;&nbsp;Testausf&uuml;hrung mit Reportgenerierung</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Hier werden die XML- und HTML-Reportdateien in einem Verzeichnis erstellt, dessen Name
          sowohl die Testsuite wie auch Datum und Uhrzeit enth&auml;lt, etwa:
          <code>c:\mylogs\rep_suiteA_0806042152</code>. Ersetzt man das Argument
          <code>-report</code> durch <code>-report.xml</code> bzw. <code>-report.html</code>, so
          wird nur der XML- bzw. nur der HTML-Report erstellt.
        </p>
        
<p>
          Testf&auml;lle sind oft parametrisiert, das hei&szlig;t, sie verwenden Variablen, deren Werte den
          Testablauf bestimmen. Ist beispielsweise im <a href="rootnode.html#step_RootStep" shape="rect">'Testsuite'</a> Knoten eine Variable
          <code>myvar</code> definiert, kann deren Vorgabewert zur Testausf&uuml;hrung &uuml;berschrieben
          werden:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>qftest -batch -variable myvar="Value from command line" -runlog c:\mylogs\+b c:\mysuites\suiteA.qft</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.5:&nbsp;&nbsp;Testausf&uuml;hrung mit Variablen</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Sollen mehrere Variablen gesetzt werden, kann <code>-variable
          &lt;name&gt;=&lt;wert&gt;</code> auch mehrfach angegeben werden.
        </p>
      

      
      

      
<a name="sec_N90433"></a>
        
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_N90433">22.1.2</a></span>
</div>
<a href="contents.html#toc_sec_N90433">Windows Befehlsskript</a>
</h5>
        
<p>
          Die M&ouml;glichkeit, Tests &uuml;ber die Kommandozeile ausf&uuml;hren zu k&ouml;nnen, bildet die
          Grundlage zur einfachen Integration von QF-Test in bestehende Testmanagement-Systeme
          (siehe <a href="user_testmanagement.html#usec_testmanagement">Anbindung an Testmanagementtools</a>). Wer hingegen kein Testmanagement-System
          betreibt, mag es vielleicht praktisch finden, das Kommando zur Testausf&uuml;hrung in ein
          Skript einzubetten. Ein einfaches Windows Befehlsskript (<code>qfbatch.bat</code>)
          k&ouml;nnte zum Beispiel wie folgt aussehen:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>@echo off
setlocal
if "%1" == "" (
    echo Usage: qfbatch Testsuite
    goto end
) else (
    set suite=%~f1
)
set logdir=c:\mylogs
pushd c:\programs\qftest\qftest-6.0.3\bin

@echo on
.\qftest -batch -compact -runlog %logdir%\+b %suite%
@echo off

if %errorlevel% equ 0 (
  echo Test terminated successfully
  goto end
)
if %errorlevel% equ 1 (
  echo Test terminated with warnings
  goto end
)
if %errorlevel% equ 2 (
  echo Test terminated with errors
  goto end
)
if %errorlevel% equ 3 (
  echo Test terminated with exceptions
  goto end
)
if %errorlevel% leq -1 (
  echo Error %errorlevel%
  goto end
)

:end
popd</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.6:&nbsp;&nbsp;Befehlsskript <code>qfbatch.bat</code> zur Ausf&uuml;hrung einer Testsuite</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Nun braucht man nur noch das Skript auszuf&uuml;hren, mit dem Dateinamen der auszuf&uuml;hrenden
          Testsuite als Parameter. Der Rest geht von alleine: Die Testsuite wird ausgef&uuml;hrt, die
          Protokolldatei im Verzeichnis <code>logdir</code> abgelegt und abschlie&szlig;end gibt das
          Skript in Abh&auml;ngigkeit vom QF-Test R&uuml;ckgabewert eine Statusmeldung aus.
        </p>
      

      
      

      
<a name="sec_N90473"></a>
        
<h5 class="header-container h5">
<div>
<span class="margin"><a name="new_N90477"></a><span class="note">3.0+</span></span><span class="numtitle"><a href="contents.html#toc_sec_N90473">22.1.3</a></span>
</div>
<a href="contents.html#toc_sec_N90473">Groovy</a>
</h5>
        
<p>
          Seit Version 3 ist die Sprache Groovy Bestandteil von QF-Test (siehe <a href="user_scripting.html#usec_scripting">Kapitel 11</a>). Haupts&auml;chlich gedacht ist sie zum Schreiben von Server- und
          SUT-Skripten, aber Groovy kann ebenso wie Jython auch au&szlig;erhalb von QF-Test verwendet werden.
          Diese Sprache ist sicher gut geeignet, um sich selbst ein kleines Management-System
          zur Testautomatisierung zu erstellen. Mit Groovy l&auml;sst sich &uuml;brigens auch der Einsatz
          von Ant vereinfachen, denn statt mit klobigen XML-Dateien, &uuml;ber die sich zudem etwa
          Bedingungen nur schwer umsetzen lassen, kann man dank <code>AntBuilder</code> mit
          &uuml;bersichtlichem Groovy-Code arbeiten. Das folgende Beispiel kommt allerdings ohne Ant
          aus:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>def suite = ''
if (args.size() == 0) {
    println 'Usage: groovy QfExec Testsuite'
    return
}
else {
    suite = args[0]
}

def qftestdir = 'c:\\programs\\qfs\\qftest\\qftest-6.0.3'
def qftest = qftestdir + '\\bin\\qftest.exe'
def command = [qftest,
              "-batch",
              "-compact",
              "-runlog", "c:\\mylogs\\+b",
              suite]
def printStream = { stream -&gt;
    while (true) {
        try {
            stream.eachLine { println it }
        } catch (IOException) {
            break
        }
    }
}

println "Running command: $command"
def proc = command.execute()
new Thread().start() { printStream(proc.in) }
new Thread().start() { printStream(proc.err) }
proc.waitFor()

switch (proc.exitValue()) {
    case '0': println 'Test terminated successfully'; break
    case '1': println 'Test terminated with warnings'; break
    case '2': println 'Test terminated with errors'; break
    case '3': println 'Test terminated with exceptions'; break
    default: println "Error ${proc.exitValue()}"
}</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.7:&nbsp;&nbsp;Groovy Skript <code>QfExec.groovy</code> zur Ausf&uuml;hrung einer Testsuite</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Sollte Groovy unabh&auml;ngig von QF-Test auf Ihrem Rechner installiert sein, kann die
          Beispiel-Testsuite einfach mit <code>groovy QfExec c:\mysuites\suiteA.qft</code>
          ausgef&uuml;hrt werden. Andernfalls kann auch die Groovy jar-Datei aus der QF-Test
          Installation verwendet werden. Am besten nutzt man in diesem Fall zur Ausf&uuml;hrung von
          Groovy wieder ein Befehlsskript:
        </p>
        
<table class="example" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3">
<table width="100%" cellspacing="0">
<tr>
<td class="example"><pre>@echo off
setlocal
if "%1" == "" (
    echo Usage: qfexec Testsuite
    goto end
)
set qftestdir=c:\programs\qftest\qftest-6.0.3
set scriptfile=QfExec.groovy
java -cp %qftestdir%/lib/groovy-all.jar groovy.ui.GroovyMain %scriptfile% %*
:end</pre></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption">Beispiel&nbsp;22.8:&nbsp;&nbsp;Befehlsskript <code>qfexec.bat</code> zur Ausf&uuml;hrung von Groovy (hier
          <code>QfExec.groovy</code>)</td><td class="captionglue"></td>
</tr>
</table>
        
<p>
          Die Testsuite kann nun mit <code>qfexec c:\mysuites\suiteA.qft</code> ausgef&uuml;hrt
          werden.
        </p>
      

      
    
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="navifooter">
<tr>
<td class="margin"></td><td class="navicon"><a href="manual.html"><img src="../icons/linktop.png" width="34" height="36" border="0" alt="Top" title="Top"></a></td><td class="navicon"><a href="contents.html#table-of-contents"><img src="../icons/linktoc.png" width="34" height="36" border="0" alt="Inhaltsverzeichnis" title="Inhaltsverzeichnis"></a></td><td class="navicon"><img src="../icons/linkprevdis.png" width="34" height="36" alt="" border="0"></td><td class="navicon"><a href="user_execdaemon.html#usec_execdaemon"><img src="../icons/linkcont.png" width="34" height="36" border="0" alt="N&auml;chste Seite: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus" title="N&auml;chste Seite: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus"></a></td><td class="navicon"><a href="user_execdaemon.html#usec_execdaemon"><img src="../icons/linknext.png" width="34" height="36" border="0" alt="N&auml;chstes Kapitel: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus" title="N&auml;chstes Kapitel: 22.2&nbsp;Testausf&uuml;hrung im Daemonmodus"></a></td><td class="navicon"><a href="user_testexecution.html#usec_testexecution"><img src="../icons/linkup.png" width="34" height="36" border="0" alt="Kapitel-&Uuml;bersicht: 22&nbsp;Testausf&uuml;hrung" title="Kapitel-&Uuml;bersicht: 22&nbsp;Testausf&uuml;hrung"></a></td><td class="navicon"><a href="../../manual_de.pdf" target="_parent"><img src="../icons/linkpdf.png" width="34" height="36" border="0" alt="PDF Version" title="PDF Version"></a></td><td class="navcopymod">Letzte &Auml;nderung: 6.9.2022<br>Copyright &copy; 1999-2022 Quality First Software GmbH</td>
</tr>
</table>
</body>
</html>
