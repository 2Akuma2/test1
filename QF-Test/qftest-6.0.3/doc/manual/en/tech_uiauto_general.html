<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="6.0.3">
<link rel="shortcut icon" href="../icons/favicon.ico" type="image/vnd.microsoft.icon">
<title>Proceeding</title>
<link href="man.css" type="text/css" rel="stylesheet">
<meta name="organisation" content="Quality First Software GmbH">
<meta name="copyright" content="(C) 1999-2022 Quality First Software GmbH">
</head>
<body bgcolor="white">
<a name="usec_uiauto_general"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="naviheader">
<tr>
<td class="margin"></td><td class="navicon"><a href="manual.html"><img src="../icons/linktop.png" width="34" height="36" border="0" alt="Top" title="Top"></a></td><td class="navicon"><a href="contents.html#table-of-contents"><img src="../icons/linktoc.png" width="34" height="36" border="0" alt="Table of contents" title="Table of contents"></a></td><td class="navicon"><img src="../icons/linkprevdis.png" width="34" height="36" alt="" border="0"></td><td class="navicon"><a href="tech_uiauto_example.html#usec_uiauto_example"><img src="../icons/linkcont.png" width="34" height="36" border="0" alt="Next Page: 48.2&nbsp;Example" title="Next Page: 48.2&nbsp;Example"></a></td><td class="navicon"><a href="tech_uiauto_example.html#usec_uiauto_example"><img src="../icons/linknext.png" width="34" height="36" border="0" alt="Next Chapter: 48.2&nbsp;Example" title="Next Chapter: 48.2&nbsp;Example"></a></td><td class="navicon"><a href="tech_uiauto.html#usec_uiauto"><img src="../icons/linkup.png" width="34" height="36" border="0" alt="Chapter Overview: 48&nbsp;Controlling native Windows applications via the UIAuto module - 
               without the QF-Test win engine" title="Chapter Overview: 48&nbsp;Controlling native Windows applications via the UIAuto module - 
               without the QF-Test win engine"></a></td><td class="navicon"><a href="../../manual_en.pdf" target="_parent"><img src="../icons/linkpdf.png" width="34" height="36" border="0" alt="PDF version" title="PDF version"></a></td><td class="homeicon"><a href="http://www.qfs.de/en/qftest/index.html" target="_parent"><img src="../icons/qftest.png" width="127" height="42" border="0" alt="QF-Test" title="QF-Test"></a></td>
</tr>
</table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="naviversion">
<tr>
<td>Version 6.0.3</td>
</tr>
</table>
      
<h4 class="header-container h4">
<div>
<span class="numtitle"><a href="contents.html#toc_usec_uiauto_general">48.1</a></span>
</div>
<a href="contents.html#toc_usec_uiauto_general">Proceeding</a>
</h4>
      
<p>
        The Microsoft UI Automation is an Accessibility and Test Framework allowing programs to
        control the GUI elements of native Windows applications. With QF-Test you can use the framework
        in script nodes via the Jython module <code>uiauto</code>
        (alternatively <code>de.qfs.UIAuto</code> for Groovy, <code>uiauto</code> for Javascript).
      </p>
      
<p>
        QF-Test provides a package in the standard library
        with procedures for the most commonly needed interactions with GUI elements
        for direct and easy use of the API for test development. This chapter describes
        the standard library package.
      </p>
      
<p>
        You will find the procedures relevant for control of native Windows elements in
        the package <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin"><code>qfs.autowin</code></a>. You can see several procedures marked as
        deprecated. They have been replaced by normal nodes of the <code>win</code> engine of QF-Test,
        and the procedures in the <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin"><code>qfs.autowin</code></a> package will not be further maintained. 
        However, you can continue using them as they are. If you encounter problems, for example with 
        scaled windows applications, it is advised to switch to the <code>win</code> engine.
      </p>
      
<a name="fig_uiauto_stdlib"></a><a name="figure_48.1"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/uiauto_stdlib.png" target="_blank"><img texscale=".66" src="images/uiauto_stdlib.png" width="349" height="706"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;48.1</a>:&nbsp;&nbsp;UI Automation procedures in the standard library</td><td class="captionglue"></td>
</tr>
</table>
      
<p>
        When developing tests for native windows applications you generally need
        to perform the following steps:
      </p>
      
<ul>
        
<li>
          Start the application
        </li>
        
<li>
          Determine the identifying parameters for the GUI elements
        </li>
        
<li>
          Set up the tests calling the respective procedures specifying the GUI elements
          via the identifiers.
        </li>
      
</ul>
      
<a name="usec_uiauto_start_general"></a>
        
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_usec_uiauto_start_general">48.1.1</a></span>
</div>
<a href="contents.html#toc_usec_uiauto_start_general">Starting the application</a>
</h5>
        
<p>
          The application to be tested may but does not
          necessarily have to be started via QF-Test.
        </p>
        
<p>
          When starting the application via QF-Test the client process started is listed in
          the QF-Test menu &raquo;<em>Clients</em>&laquo; and can also be stopped via
          QF-Test.
        </p>
        
<p>
          Please use the procedure <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.checkForExistence"><code>qfs.autowin.checkForExistence</code></a>
          to check whether the application was started.
        </p>
        
<p>
          You will find an example for the start of an application in
          <a href="tech_uiauto_example.html#usec_uiauto_start_example">subsection 48.2.1</a>.
        </p>
      
      
<a name="usec_uiauto_dump_controls_general"></a>
        
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_usec_uiauto_dump_controls_general">48.1.2</a></span>
</div>
<a href="contents.html#toc_usec_uiauto_dump_controls_general">Listing the GUI elements of a window</a>
</h5>
        
<p>
          Before you can set up a test you need to get an overview of the GUI elements
          of the application. You may either use the procedure
          <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.helpers.dumpComponents"><code>qfs.autowin.helpers.dumpComponents</code></a> to print the
          GUI elements to the QF-Test terminal or
          <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.helpers.dumpComponentsToFile"><code>qfs.autowin.helpers.dumpComponentsToFile</code></a> to write them
          to a file.
        </p>
        
<p>
          The procedure <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.helpers.DumpDesktopWindows"><code>qfs.autowin.helpers.DumpDesktopWindows</code></a> allows
          you to list the titles of all open windows of the desktop.
        </p>
        
<p>
          
<a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.helpers.dumpComponents"><code>qfs.autowin.helpers.dumpComponents</code></a> prints the name (Name),
          the class (ClassName), the compontent type
          (ControlType) and the Id (AutomationId) of the GUI elements, provided they
          were implemented for the respective GUI element.
        </p>
        
<p>
          All the GUI elements visible on the Windows desktop are organized in
          a tree structure with the desktop as the root element. When calling the
          dump procedure you need to specify the window for which to list the
          GUI elements. Nesting of the components is represented via indentation.
        </p>
        
<p>
        
<span class="margin"><span class="note">Note</span></span>
          The procedure dumpComponents() prints its output to the QF-Test terminal
          displayed in the botton part of the QF-Test window. The output is not displayed
          in the terminals which can be opened separately (client terminal and
          scripting terminals).
        </p>
        
<p>
          Please find an example in <a href="tech_uiauto_example.html#usec_uiauto_dump_controls_example">subsection 48.2.2</a>.
        </p>
      
      
<a name="sec_N172679"></a>
        
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_N172679">48.1.3</a></span>
</div>
<a href="contents.html#toc_sec_N172679">Information on single GUI elements</a>
</h5>
        
<p>
          The procedure <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.helpers.dumpComponent"><code>qfs.autowin.helpers.dumpComponent</code></a>
          allows you to print further information for single GUI elements,
          including a list of the methods available for the element as well as
          attribute values.
        </p>
      
      
<a name="usec_uiauto_controls_general"></a>
        
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_usec_uiauto_controls_general">48.1.4</a></span>
</div>
<a href="contents.html#toc_usec_uiauto_controls_general">Identifiers for GUI elements</a>
</h5>
        
<p>
          All procedures of the standard library package preforming actions on native
          Windows applications need to determine the respective GUI element as the
          first step and then perform the action in a second step. You find the
          procedures in the package <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component"><code>qfs.autowin.component</code></a>.
          Because all procedures use <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.getControl"><code>qfs.autowin.component.getControl</code></a>
          to identify the GUI element, the parameters of this helper procedure are valid
          for all the procedures performing an action on a GUI element.

        </p>
        
<p>
          The following parameters (and combinations) are valid (in the order of evaluation):
        </p>
        
<ul>
          
<li>
            AutomationId
          </li>
          
<li>
            ControlType and name
          </li>
          
<li>
            ControlType and index
          </li>
          
<li>
            ClassName and name
          </li>
          
<li>
            ClassName and index
          </li>
          
<li>
            Name
          </li>
        
</ul>
        
<dl>
          
<dt>AutomationId</dt>
          
<dd>
            The AutomationId is a unique identifier for the GUI element within a window.
            It has to be set explicitly during application development, which unfortunately
            does not always happen.
          </dd>
          
<dt>Name</dt>
          
<dd>
            The name usually corresponds to the text displayed.
            Names do not have to be unique and you may have to specify the ControlType or the
            ClassName of the GUI element additionally.
          </dd>
          
<dd>
            Names will be evaluated as regular expressions. For more information about
            regular expressions please see <a href="tech_regexp.html#sec_regexp">Regular expressions</a>.
          </dd>
          
<dt>ControlType</dt>
          
<dd>
            The ControlType is a value from a predefined list of component types, e.g.
            Button, CheckBox, ComboBox, DataGrid, Edit, List, Tab, Text.
            The procedure <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.helpers.dumpComponent"><code>qfs.autowin.helpers.dumpComponent</code></a> shows
            the name and the numeric value of the respective ControlType. In order to
            identify a GUI element via its ControlType you usually need to specify its name
            or its index (relative to the GUI elements in the window of that ControlType), too,
            except there is just the one GUI element of that ControlType in the window.
          </dd>
          
<dt>ClassName</dt>
          
<dd>
            ClassNames are framework specific. Additionally to the ClassName you may
            specify the name or the index (relative to the
            GUI elements in the window of that ClassName) of the GUI element.
          </dd>
        
</dl>
      
      
<a name="usec_uiauto_actions_general"></a>
        
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_usec_uiauto_actions_general">48.1.5</a></span>
</div>
<a href="contents.html#toc_usec_uiauto_actions_general">Actions on GUI elements</a>
</h5>
        
<p>
          You will find procedures in the package <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component"><code>qfs.autowin.component</code></a>
          of the standard library for the most common actions. You are free to enhance the
          package. We recommend to use a separate test-suite for the enhancement and not to
          change the qfs.qft since we continuously update the standard library and ship
          a new version with every QF-Test release.
        </p>
        
<dl>
          
<dt>Mouse click</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.click"><code>qfs.autowin.component.click</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            The procedure tries to replay a click event to the GUI element. In case
            this is not implemented the procedure replays a hard mouse click to the
            position of the GUI element.
          </dd>
          
<dt>Wait for component</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.waitForComponent"><code>qfs.autowin.component.waitForComponent</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            The procedure waits for the given component and returns control to the calling
            node as soon as it finds the component. The given timeout (in milliseconds)
            is the maximum time to wait. It throws an exception if the component
            is not found within the given time.
          </dd>
          
<dt>Wait for window</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.checkForExistence"><code>qfs.autowin.checkForExistence</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            The procedure waits for the given window and returns control to the calling
            node as soon as it finds the window. The given timeout (in milliseconds)
            is the maximum time to wait. The parameter 'errorLevel' specifies whether
            to log a message, warning, error or an exception in case the the window
            is not found within the given time.
          </dd>
          
<dt>Text input</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.setText"><code>qfs.autowin.component.setText</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            The procedure uses the method setText() of the IUIAutomationElement interface
            to enter a text to the given component. In case the setText() method has not
            been implemented for the component please use setValue().
          </dd>
          
<dt>Keyboard events</dt>
          
<dd>
            The Package <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.keyevents"><code>qfs.autowin.keyevents</code></a> provides procedures for
            replaying the keyboard events ENTER, TAB and DELETE. The procedure
            <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.keyevents.sendKey"><code>qfs.autowin.keyevents.sendKey</code></a> lets you replay any key
            like a single letter, a digit, a function key, etc, also combined with the modifiers  SHIFT, CTRL and ALT.
            The event is replayed to the component with the focus in the given window.
            <br>
<br>
          
</dd>
          
<dt>Fetch text</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.getText"><code>qfs.autowin.component.getText</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            The text of a GUI element cannot be accessed directly. The name of a GUI elements
            usually corresponds to the text displayed. Some elements have a value corresponding to the
            text, independently of the name.The procedure getText()
            first tries to determine the value of the element and,
            in case this fails or the value is an empty string, returns the name of the element.
            <br>
<br>
          
</dd>
          
<dd>
            The procedures getName() and getValue() are provided additionally.
          </dd>
          
<dt>Fetch geometry</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.getGeometry"><code>qfs.autowin.component.getGeometry</code></a> 
<br>
<br>
          
</dd>
          
<dt>Check text</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.checkText"><code>qfs.autowin.component.checkText</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            The procedure fetches the text of the GUI elements via the  procedure getText()
            and compares the value returned with the given text. <br>
<br>
          
</dd>
          
<dd>
            The procedures checkName() and checkValue() are provided additionally.
          </dd>
          
<dt>Check geometry</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.checkGeometry"><code>qfs.autowin.component.checkGeometry</code></a>  
<br>
<br>
          
</dd>
          
<dd>
            The procedure fetches the geometry data via getGeometry() and compares them
            to the given values.
          </dd>
          
<dt>Image check</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.checkImage"><code>qfs.autowin.component.checkImage</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            The procedure relies on a file with a reference image.
            The file needs to have a <code>png</code> format. The procedure determines the
            screen coordinates of the element via <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.component.getGeometry"><code>qfs.autowin.component.getGeometry</code></a>.
            The actual comparison is done via the procedure getPositionOfImage()
            of the <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autoscreen"><code>qfs.autoscreen</code></a> package of the standard library.
            <br>
<br>
          
</dd>
          
<dt>Select an item in a menu</dt>
          
<dd>
            Procedure: <a href="../../../include/qfs_pkgdoc/qfs_pkgdoc.html#qfs.autowin.menu.selectItem"><code>qfs.autowin.menu.selectItem</code></a> 
<br>
<br>
          
</dd>
          
<dd>
            Especially when single-stepping through the test when debugging it is
            useful to have a procedure which clicks to a menu and its menu item which
            can be executed in one step. Thus the application will not loose the
            focus between steps which might cause the menu to close.
          </dd>
        
</dl>
      
    
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="navifooter">
<tr>
<td class="margin"></td><td class="navicon"><a href="manual.html"><img src="../icons/linktop.png" width="34" height="36" border="0" alt="Top" title="Top"></a></td><td class="navicon"><a href="contents.html#table-of-contents"><img src="../icons/linktoc.png" width="34" height="36" border="0" alt="Table of contents" title="Table of contents"></a></td><td class="navicon"><img src="../icons/linkprevdis.png" width="34" height="36" alt="" border="0"></td><td class="navicon"><a href="tech_uiauto_example.html#usec_uiauto_example"><img src="../icons/linkcont.png" width="34" height="36" border="0" alt="Next Page: 48.2&nbsp;Example" title="Next Page: 48.2&nbsp;Example"></a></td><td class="navicon"><a href="tech_uiauto_example.html#usec_uiauto_example"><img src="../icons/linknext.png" width="34" height="36" border="0" alt="Next Chapter: 48.2&nbsp;Example" title="Next Chapter: 48.2&nbsp;Example"></a></td><td class="navicon"><a href="tech_uiauto.html#usec_uiauto"><img src="../icons/linkup.png" width="34" height="36" border="0" alt="Chapter Overview: 48&nbsp;Controlling native Windows applications via the UIAuto module - 
               without the QF-Test win engine" title="Chapter Overview: 48&nbsp;Controlling native Windows applications via the UIAuto module - 
               without the QF-Test win engine"></a></td><td class="navicon"><a href="../../manual_en.pdf" target="_parent"><img src="../icons/linkpdf.png" width="34" height="36" border="0" alt="PDF version" title="PDF version"></a></td><td class="navcopymod">Last update: 9/6/2022<br>Copyright &copy; 1999-2022 Quality First Software GmbH</td>
</tr>
</table>
</body>
</html>
