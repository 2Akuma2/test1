<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="version" content="6.0.3">
<link rel="shortcut icon" href="../icons/favicon.ico" type="image/vnd.microsoft.icon">
<title>Dependencies: Automatically ensuring correct prerequisites for
    each Test-case</title>
<link href="man.css" type="text/css" rel="stylesheet">
<meta name="organisation" content="Quality First Software GmbH">
<meta name="copyright" content="(C) 2002-2022 Quality First Software GmbH">
</head>
<body bgcolor="white">
<a name="sec_AdvDeps"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="naviheader">
<tr>
<td class="margin"></td><td class="navicon"><a href="tutorial.html"><img src="../icons/linktop.png" width="34" height="36" border="0" alt="Top" title="Top"></a></td><td class="navicon"><a href="contents.html#table-of-contents"><img src="../icons/linktoc.png" width="34" height="36" border="0" alt="Table of contents" title="Table of contents"></a></td><td class="navicon"><a href="datadriven.html#sec_DataDriven"><img src="../icons/linkprev.png" width="34" height="36" border="0" alt="Previous Chapter: 28&nbsp;Data driven Testing: Running one 'Test-case' with different test
    data" title="Previous Chapter: 28&nbsp;Data driven Testing: Running one 'Test-case' with different test
    data"></a></td><td class="navicon"><a href="tut_procbuilder.html#sec_AdvProcbuilder"><img src="../icons/linkcont.png" width="34" height="36" border="0" alt="Next Page: 30&nbsp;Automated creation of basic procedures" title="Next Page: 30&nbsp;Automated creation of basic procedures"></a></td><td class="navicon"><a href="tut_procbuilder.html#sec_AdvProcbuilder"><img src="../icons/linknext.png" width="34" height="36" border="0" alt="Next Chapter: 30&nbsp;Automated creation of basic procedures" title="Next Chapter: 30&nbsp;Automated creation of basic procedures"></a></td><td class="navicon"><a href="advanced.html#sec_advanced"><img src="../icons/linkup.png" width="34" height="36" border="0" alt="Chapter Overview: V&nbsp;Advanced features of QF-Test" title="Chapter Overview: V&nbsp;Advanced features of QF-Test"></a></td><td class="navicon"><a href="../../tutorial_en.pdf" target="_parent"><img src="../icons/linkpdf.png" width="34" height="36" border="0" alt="PDF version" title="PDF version"></a></td><td class="homeicon"><a href="http://www.qfs.de/en/qftest/index.html" target="_parent"><img src="../icons/qftest.png" width="127" height="42" border="0" alt="QF-Test" title="QF-Test"></a></td>
</tr>
</table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="naviversion">
<tr>
<td>Version 6.0.3</td>
</tr>
</table>
    
<h3 class="header-container h3">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_AdvDeps">29</a></span>
</div>
<a href="contents.html#toc_sec_AdvDeps">Dependencies: Automatically ensuring correct prerequisites for
    each 'Test-case'</a>
</h3>

    
<p>
      
<span class="margin"><span class="note"><img src="../icons/video.png" width="32" height="32" border="0" alt="Video" title="Video"></span></span>
      Video: <a href="https://www.qfs.de/en/yt/dependencies-basics-50.html" class="videolink" target="_blank"> Dependencies</a>
    
</p>
    
<p>
      This chapter explains the dependency concept of QF-Test.
      That concept is important for creating robust test-cases and for
      defining recovery activities, if a single test-case crashes during the
      test run. It has been introduced to guarantee that any test-case's prerequisites are fulfilled before running it.
    </p>
    
<p>
      You can find the following examples in the file
      <code>qftest-6.0.3/doc/tutorial/ advanced-demos/en/dependencies.qft</code>.
      There is also a second test-suite
      <code>qftest-6.0.3/doc/tutorial/ advanced-demos/en/dependencies_work.qft</code>
      to perform your own implementations. Please take care to copy all test-suites to a project-related folder first and modify them there.
    </p>

    

    
<a name="sec_depsGeneral"></a>
      
<h4 class="header-container h4">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_depsGeneral">29.1</a></span>
</div>
<a href="contents.html#toc_sec_depsGeneral">General</a>
</h4>
   
<p>
        Please copy the test-suite
        <code>qftest-6.0.3/doc/tutorial/ advanced-demos/en/dependencies_work.qft</code>
        to a project-related folder first and open it there.
        Take a look at the first 'Test-set' 'Discount Tests'.
        It contains three different 'Test-case' nodes and the respective
        'Setup' and 'Cleanup' to launch and stop the SUT
        before each 'Test-case'.
        That is a typical test-suite you might have created yourself.
      </p>
      
<a name="fig_depWorkTestSuite"></a><a name="figure_29.1"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyWorkSuite.png" target="_blank"><img texscale=".66" src="images/DependencyWorkSuite.png" width="199" height="98"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.1</a>:&nbsp;&nbsp;First 'Test-set' of dependencies_work.qft</td><td class="captionglue"></td>
</tr>
</table>
      
<p>
        Let us assume you just want to launch one specific 'Test-case',
        because that one failed or it verifies a specific defect. If you want to
        do so, you have either to run the whole 'Test-set', because you have
        to ensure that the prerequisites are fulfilled, or you run the
        'Setup' manually and run the according 'Test-case' then.
      </p>
      
<p>
        As this is a situation which is very common but not easily solvable
        with the concepts we know already, QF-Test introduces the 'Dependencies'
        concept. It is responsible for
        managing prerequisites of 'Test-cases' and allows you to run one
        'Test-case' directly. In that case QF-Test will take care of the prerequisites of
        the 'Test-case', e.g. launching the SUT, selecting a vehicle and so on.
      </p>
      
<p>A 'Dependency' can contain a 'Setup', a 'Cleanup', an
   'Error handler' and a 'Catch' node.
   The 'Setup' of a 'Dependency' will be executed before
      each 'Test-case'. This is because the correct pre-conditions of a
   'Test-case' are a very important aspect of a robust test-run. You could
   imagine a situation where one 'Test-case' closes the SUT because of a
   mistake. Then the next test-case has to launch the SUT again. Exactly for
   this situation, the 'Dependency' concept provides a very stable and fancy
   solution.
      </p>
      
<p>The second aspect of 'Dependencies' is that they optimize the
        execution of tests. With the current means we have to start the SUT before
        each 'Test-case' and stop the SUT after each. That is no problem
        for a small application like the JCarConfigurator, but for huge
        applications, like Eclipse/RCP application or any ERP system, this might become
        insufficient.
        That is why 'Dependencies' call the 'Cleanup' steps only if required.
      </p>
      
<p>
        Another advantage of the 'Dependencies' concept are global 'Error handler' and 'Catch' for recovery
        management. This feature becomes quite important, if you run lots of
        test-cases in a series and one is failing and preventing the other
        test-cases from continuing execution because of modal error dialogs,
        e.g. 'OutOfMemoryException'.
      </p>

  
<p>In a nutshell 'Dependencies' are
      </p>
      
<ol>
        
<li>a place to define the prerequisites of a 'Test-case'.</li>
        
<li>very helpful to make test-cases more independent from other ones.</li>
        
<li>a better approach of implementing 'Setup' and 'Cleanup' steps.</li>
        
<li>allows you to implement recovery steps in case of errors or exceptions.</li>
        
<li>optimizing test-execution.</li>
        
<li>re-usable as they can be defined in the 'Procedures' area.</li>
      
</ol>
      
<p>
        The following sections demonstrate how to use 'Dependencies'.
      </p>

    

    
    

  
<a name="sec_firstDep"></a>
    
<h4 class="header-container h4">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_firstDep">29.2</a></span>
</div>
<a href="contents.html#toc_sec_firstDep">Ensuring prerequisites</a>
</h4>
    
<p>
        Please copy the test-suite
        <code>qftest-6.0.3/doc/tutorial/ advanced-demos/en/dependencies_work.qft</code>
        to a project-related folder first and open it there if you haven't done that so far.
    </p>
    
<p>This file contains a 'Test-set' 'Discount Tests' with three 'Test-cases' and the
  conventional implementation using the 'Setup' and 'Cleanup'. We
  will change this 'Test-set' to make use of a 'Dependency' now.
    </p>
  
<a name="fig_depFirstDepWorkTestSuite"></a><a name="figure_29.2"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyWorkSuite.png" target="_blank"><img texscale=".66" src="images/DependencyWorkSuite.png" width="199" height="98"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.2</a>:&nbsp;&nbsp;First 'Test-set' of dependencies_work.qft</td><td class="captionglue"></td>
</tr>
</table>
  
<p>
    First we have to insert a 'Dependency' node. This can be achieved by a
  right click at the 'Test-set' and then selecting &raquo;<em>Insert node</em>&laquo;-&raquo;<em>Dependencies</em>&laquo;-&raquo;<em>Dependency</em>&laquo;. Specify a name for that 'Dependency',
  e.g. "SUT started".
      </p>
  
<p>
    The next step is to move the 'Setup' and 'Cleanup' nodes into that
  'Dependency'.
  Therefore open the 'Dependency' node and move the mentioned nodes into
  it. You can do this via drag and drop or via right mouse click &raquo;<em>Cut</em>&laquo; and &raquo;<em>Paste</em>&laquo; or [Ctrl-X] and [Ctrl-V].
    </p>
  
<p>
    The test-suite should now look like this:
  </p>
  
<a name="fig_firstDependencySample"></a><a name="figure_29.3"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/FirstDependency.png" target="_blank"><img texscale=".66" src="images/FirstDependency.png" width="219" height="114"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.3</a>:&nbsp;&nbsp;Sample test-suite with the first 'Dependency'</td><td class="captionglue"></td>
</tr>
</table>
  
<p>
        Let us test the 'Dependency' now: Please stop all running clients
        before that, then select one 'Test-case', e.g. 'Discount 10', and run
        it.
      </p>
      
<p>
        You should see that the 'Test-case' 'Discount 10' has been executed and the SUT
        has not been stopped at the end of the test-run. Please open the
        run-log to make a deeper analysis of what happened.
      </p>
      
<a name="fig_firstDepSampleRunLog"></a><a name="figure_29.4"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/FirstDependencyRunLog.png" target="_blank"><img texscale=".66" src="images/FirstDependencyRunLog.png" width="500" height="258"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.4</a>:&nbsp;&nbsp;The run-log of the execution</td><td class="captionglue"></td>
</tr>
</table>
 
<p>
        If you open the 'Test-case' in the run-log, you can see a 'Resolve
        dependency' node. Open it and there you find two nodes. The
        last one shows that the 'Setup' has been
        executed. The other one will be explained in following chapters.
      </p>
      
<p>
        So far we have determined that the 'Setup' node will be automatically
        executed before a 'Test-case', if the 'Dependency' is defined at the
        'Test-set' level, but the 'Cleanup' has not been executed so far.
        If you start another 'Test-case' now, e.g. 'Discount 15', the already started SUT is used.
      </p>
      
<p>
        The 'Setup' node of a 'Dependency' will be executed before each
        'Test-case' in any case. That is to ensure that the prerequisites are fulfilled for each single 'Test-case'.
        The 'Cleanup' node of a
        'Dependency' will only be executed on demand, i.e. if the steps of the
        'Setup' of that 'Dependency' are not required anymore. In our case the
        'Cleanup' steps did not get executed, because both test-cases have the
        same 'Dependency'. The test execution passed because the 'Procedure' <code>startStop.startApplication</code>
        already checks whether it's necessary to launch the application or not.
        </p>
      
<a name="fig_firstDepSampleStart"></a><a name="figure_29.5"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyTryCatch.png" target="_blank"><img texscale=".66" src="images/DependencyTryCatch.png" width="376" height="146"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.5</a>:&nbsp;&nbsp;'Procedure' startStop.startApplication</td><td class="captionglue"></td>
</tr>
</table>
      
<p>
        The next step is to launch the complete 'Test-set' by clicking it and
        pressing 'Run test'.
      </p>
 
<p>All three tests should pass and the SUT should not be
        stopped in between. We have achieved an optimized
        test-execution. The 'Cleanup' will not run because all three
        test-cases refer to the same 'Dependency'. We save a lot of time
        in executing the test-cases and we are closer to testing a real life
        behavior as users usually do not restart the SUT all the time.
      </p>
      
<p>
        The next goal is to make that 'Dependency' available for other
        'Test-sets' in our project. For this you need to move the 'Dependency'
        node into the 'Procedures' area. Then click at the 'Test-set' and
        insert a 'Dependency reference' node via &raquo;<em>Insert node</em>&laquo;-&raquo;<em>Dependencies</em>&laquo;-&raquo;<em>Dependency reference</em>&laquo;. The dialog looks similar to
        the 'Procedure call' dialog and you can select the 'Dependency' on the
        same way. The test-suite should now look like this:
      </p>
      
<a name="fig_firstDepSampleDepRef"></a><a name="figure_29.6"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyReference.png" target="_blank"><img texscale=".66" src="images/DependencyReference.png" width="262" height="162"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.6</a>:&nbsp;&nbsp;The test-suite with a 'Dependency reference'</td><td class="captionglue"></td>
</tr>
</table>
      
<p>
        We recommend to add all 'Dependencies'
        to a separate 'Package' called 'dependencies'.
      </p>
      
<p>
        If you run the 'Test-set' the first time after moving the 'Dependency', QF-Test stops the SUT before the first
        'Test-case' and re-starts the SUT, because the 'Dependency' from
        the 'Test-set' is different from the 'Dependency' defined in the
        'Procedures' node. But this will be explained more detailed in following chapters.
      </p>
       
<p>
    Please take a closer look at the second 'Test-set' 'Discount Tests with SUT
    stop' of the demo test-suite. The second 'Test-case' 'Dicount 10' stops the
    SUT. But the third 'Test-case' also relies on a running SUT. As we know the
    'Dependencies' concept already, we should see that the SUT will be started
    for the third 'Test-case' again. That is exactly the advantage of the
    'Dependencies' concept.
  </p>
     
<a name="fig_firstDepEnsuringPreReqs"></a><a name="figure_29.7"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyPreReqs.png" target="_blank"><img texscale=".66" src="images/DependencyPreReqs.png" width="520" height="530"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.7</a>:&nbsp;&nbsp;Ensuring prerequisites for 'Test-case' 'Discount 15'</td><td class="captionglue"></td>
</tr>
</table>

    

    
    

  
<a name="sec_depCombine"></a>
    
<h4 class="header-container h4">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_depCombine">29.3</a></span>
</div>
<a href="contents.html#toc_sec_depCombine">Combining dependencies</a>
</h4>
    
<p>
      Managing prerequisites can be a more complex matter than just verifying
      whether the SUT is up and running. In many projects several groups
      of test-cases with different prerequisites like others exist.
    </p>
    
<p>
      Let us assume you want to test a big ERP system with more views, like a
      'vendor' view and an 'article' view. Then all tests for the 'vendor'
      view will rely on an opened 'vendor' view and all tests for the
      'article' view rely on an opened 'article' view. The opening of the
      specific view again relies on a logged-in user and the login depends on a
      started SUT. So you can see something like a tree of prerequisites.
    </p>
    
<p>
      QF-Test allows the user to build such a structure of 'Dependency' nodes
      via adding 'Dependency reference' nodes to a 'Dependency'. We will
      build up a small example with just two dependencies for the
      JCarConfigurator now.
    </p>
    
<p>
      In the JCarConfigurator you can open a 'vehicles' dialog via the menu
      'Options' -&gt; 'Vehicles'. We want to create certain tests for that
      dialog now. Later we want to create some tests on the 'accessory'
      dialog which can also be opened via the menu via 'Options' -&gt; 'Accessories'.
    </p>
    
<p>
      First let us define the tests which we want to create.
    </p>
    
<p>Test Case 1: Create vehicle 'test1' with price '100'.</p>
    
<ul>
      
<li>Start SUT if necessary.</li>
      
<li>Open vehicles dialog via the menu.</li>
      
<li>Specify 'test1' as name and '100' for the price.</li>
      
<li>Press 'New'.</li>
      
<li>Close vehicles dialog via pressing 'Ok'.</li>
      
<li>Open vehicles dialog via the menu.</li>
      
<li>Select the newly created vehicle 'test1'.</li>
      
<li>Close the vehicles dialog via pressing 'Cancel'.</li>
      
<li>Stop SUT if necessary.</li>
    
</ul>
    
<p>Test Case 2: Create vehicle 'test2' with price '99999'.</p>
    
<ul>
      
<li>Start SUT if necessary.</li>
      
<li>Open vehicles dialog via the menu.</li>
      
<li>Specify 'test2' as name and '99999' for the price.</li>
      
<li>Press 'New'.</li>
      
<li>Close vehicles dialog via pressing 'Ok'.</li>
      
<li>Open vehicles dialog via the menu.</li>
      
<li>Select the newly created vehicle 'test2'.</li>
      
<li>Close the vehicles dialog via pressing 'Cancel'.</li>
      
<li>Stop SUT if necessary.</li>
    
</ul>
    
<p>Test Case 3: Create accessory 'testaccessory' with price '12'.</p>
    
<ul>
      
<li>Start SUT if necessary.</li>
      
<li>Open accessories dialog via the menu.</li>
      
<li>Specify 'testaccessory' as name and '12' for the price.</li>
      
<li>Press 'New'.</li>
      
<li>Press 'Ok'.</li>
      
<li>Open accessories dialog via the menu.</li>
      
<li>Select the newly created accessory 'testaccessory'.</li>
      
<li>Close the accessories dialog via pressing 'Cancel'.</li>
      
<li>Stop SUT if necessary.</li>
    
</ul>
    
<p>
      Let us take a closer look at the test-steps of the tests above.
      We see that each test case requires a running application, so we
      should implement the 'Start SUT' step as prerequisite. This has to be
      done in the 'Setup' of a 'Dependency'. The 'Stop SUT' step is an
      optional step which can be part of the 'Cleanup' of the 'Dependency'.
      This 'SUT started' 'Dependency' has been implemented by us in the
      previous examples already, so we could re-use it.
    </p>
    
<p>
      The next issue is that test-case 1 and test-case 2 require an opened
      vehicle dialog. Because we plan more tests in that area, we can
      create a new 'Dependency' 'vehicles dialog opened', which will contain
      the opening of the dialog as 'Setup' and the closing of
      the dialog via 'Cancel' as 'Cleanup'. We are able to open this
      dialog only if
      the SUT is up and running already, so this 'Dependency' is
      dependent on the 'SUT started' 'Dependency'. The implementation of
      that 'open vehicle dialog' 'Dependency' looks like this:
    </p>
      
<a name="fig_depVehicleDialog"></a><a name="figure_29.8"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/OpenVehiclesDialogDependency.png" target="_blank"><img texscale=".66" src="images/OpenVehiclesDialogDependency.png" width="463" height="194"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.8</a>:&nbsp;&nbsp;'vehicles dialog opened' 'Dependency'</td><td class="captionglue"></td>
</tr>
</table>
      
<p>
        
<span class="margin"><span class="note">Note</span></span> In the 'Setup' we have to check whether
        the dialog is already opened, because a previous test-case could have
        forgotten to close the dialog. The 'Timeout' attribute of the
        'Wait for component to appear' node is set to '0' because the dialog is expected to
        be here. If the dialog is already opened, it is
        fine and we can continue, otherwise we have to open the dialog.
        </p>
      
<p>
        We have to create a 'Dependency' 'accessories dialog opened' as well. This
        'Dependency' is
        similar to the 'vehicles dialog opened' 'Dependency', but it deals
        with the accessory dialog instead of the vehicles dialog.
        </p>
      
<p>
        After creating those dependencies we have to record the according
        test-steps and create the test-cases. The test-steps have already been
        implemented by us and you can find them in the according 'Package'
        structure in the test-suite
        <code>qftest-6.0.3/doc/tutorial/ advanced-demos/en/dependencies.qft</code>.
  </p>
      
<p>The test-cases should be organized in one 'Test-set' called
      'Combined Dependencies Tests'. This 'Test-set' should
      contain two more 'Test-sets'. The first one is 'Tests for vehicles' and
      the second one is
      'Tests for accessories'. The 'Test-set' 'Tests for vehicles' has to
      contain the implementation of test-case 1 and test-case 2 and a
      'Dependency reference' to the 'vehicles dialog opened' 'Dependency'. The
      second 'Test-set' 'Tests for accessories' has to contain test-case 3
      and a 'Dependency reference' to the 'Dependency' 'accessories dialog opened'.
      </p>
      
<a name="fig_depVehiclesAccessoriesTest"></a><a name="figure_29.9"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/VehiclesAccessoriesTestSet.png" target="_blank"><img texscale=".66" src="images/VehiclesAccessoriesTestSet.png" width="460" height="130"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.9</a>:&nbsp;&nbsp;Implementation of specified test-cases</td><td class="captionglue"></td>
</tr>
</table>
      
<p>
        If you run that 'Test-set' now, you will see that QF-Test stops the SUT
        first, because that comes from a dependency of the previous
        examples. Then QF-Test starts the SUT, performs the steps of test-case 1
        and then the steps of test-case 2. Then it will perform the steps of
        test-case 3. If you take a closer look at the beginning of test-case 3 in
        the run-log, you will see that the 'Cleanup'
        of the 'vehicles dialog opened' 'Dependency' has been executed. That happened
        because the 'vehicles dialog opened' 'Dependency' was not required
        anymore. The following test-case test-case 3 required the 'accessories
        dialog opened' 'Dependency'. However, both 'Dependencies' require the
        'SUT started' 'Dependency', that is why that 'Cleanup' of the
        'SUT started' 'Dependency'
        has not been executed.
  </p>
      
<a name="fig_depRunLogDepCombine"></a><a name="figure_29.10"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/VehiclesAccessoriesRunLog.png" target="_blank"><img texscale=".66" src="images/VehiclesAccessoriesRunLog.png" width="530" height="450"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.10</a>:&nbsp;&nbsp;Run-log of nested 'Dependencies'</td><td class="captionglue"></td>
</tr>
</table>
      
<p>
        The ability to combine dependencies or to call the 'Cleanup' of
        dependencies on demand can enable you to put a lot of preparing and
        cleaning steps into a 'Dependency'. Another use-case for the
        JCarConfigurator could be to create a 'Vehicle created' 'Dependency',
        which creates a vehicle, which is required for the test and removes it
        afterwards. That would be an approach to ensure that the test-data has
        been established correctly.
      </p>
    

    
    

    
<a name="sec_depErrorAndCatch"></a>
            
<h4 class="header-container h4">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_depErrorAndCatch">29.4</a></span>
</div>
<a href="contents.html#toc_sec_depErrorAndCatch">Error and exception handling</a>
</h4>

            
<a name="sec_depErrorHandler"></a>
                    
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_depErrorHandler">29.4.1</a></span>
</div>
<a href="contents.html#toc_sec_depErrorHandler">Error handling</a>
</h5>
                    
<p>
        Please copy the test-suite
        <code>qftest-6.0.3/doc/tutorial/ advanced-demos/en/dependencies_work.qft</code>
        to a project-related folder first and open it there if you haven't done that so far.
                            You can find a
                            'Test-set' 'Tests with error'. The second 'Test-case' of that 'Test-set'
                            fails.
                    </p>

                    
<a name="fig_depErrorTestSuite"></a><a name="figure_29.11"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyTestSuiteErrorHandler.png" target="_blank"><img texscale=".66" src="images/DependencyTestSuiteErrorHandler.png" width="262" height="82"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.11</a>:&nbsp;&nbsp;Test-suite of 'Error handler'</td><td class="captionglue"></td>
</tr>
</table>

                    
<p>
                            Let us assume that we want to trigger a specific behavior after
                            a test-case, but only if it failed.
                            In our case we could stop the SUT to guarantee that the following
                            test-case can rely on a clean environment again. We know that the
                            'Setup' node is executed before each 'Test-case' and the 'Cleanup'
                            node will only run on demand. So how could we run specific steps
                            only in case of an error?
                    </p>
                    
<p>
                            The solution is the so called 'Error handler' node
                            for a 'Dependency'.
                            You have to click at the closed 'Cleanup' node of that 'Dependency' and insert the 'Error handler' node via right
                            mouse click and selecting &raquo;<em>Insert node</em>&laquo;-&raquo;<em>Dependencies</em>&laquo;-&raquo;<em>Error handler</em>&laquo;.
                                    </p>
                                    
<p>
                                            In the 'Error handler' you can define the steps for stopping the SUT
                                            again. The 'Dependency' <code>SUT started</code> should look like this now:
                                    </p>
                                    
<a name="fig_depErrorHandlerSample"></a><a name="figure_29.12"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyErrorHandler.png" target="_blank"><img texscale=".66" src="images/DependencyErrorHandler.png" width="324" height="82"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.12</a>:&nbsp;&nbsp;'Dependency' with 'Error handler'</td><td class="captionglue"></td>
</tr>
</table>
                                    
<p>
                                            Please run the whole 'Test-set' 'Tests with error' and switch into the run-log after the
                                            test-run has finished.
                                    </p>
                                    
<p>
                                            In the run-log you can see that the 'Error handler' was executed after
                                            the second 'Test-case' only.
                                    </p>
                                    
<a name="fig_depErrorHandlerSample2"></a><a name="figure_29.13"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyRunLogErrorHandler.png" target="_blank"><img texscale=".66" src="images/DependencyRunLogErrorHandler.png" width="480" height="226"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.13</a>:&nbsp;&nbsp;Run-log for 'Dependency' with 'Error handler'</td><td class="captionglue"></td>
</tr>
</table>

                            

                            
<a name="sec_depCatch"></a>
                                    
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_depCatch">29.4.2</a></span>
</div>
<a href="contents.html#toc_sec_depCatch">Exception handling</a>
</h5>
                                    
<p>
                                            In the previous section we have learned that 'Error handler' nodes
                                            contain steps which are executed if the
                                            'Test-case' fails. Besides errors also exceptions can occur
                                            during a test-run. An exception is an unexpected behavior during the
                                            test-run, e.g. an error dialog appears suddenly or a component
                                            could not be found anymore. How should we handle such exceptions?
                                    </p>
                                    
<p>
                                            You can find an example 'Test-set' 'Tests with exception' in the test-suite <code>dependencies_work.qft</code>.
                                    </p>
                                    
<p>
                                            Of course you could surround the test-steps in each 'Test-case' by
                                            try-catch and implement a dedicated exception handling in each single
                                            'Test-case', like implemented in the demo 'Test-set'.
                                            But this approach could lead to a lot of redundancy and makes the 'Test-cases' a
                                            little bit more unreadable.
                                    </p>
                                    
<a name="fig_depCatchTryEachTest"></a><a name="figure_29.14"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyTestCaseTryCatch.png" target="_blank"><img texscale=".66" src="images/DependencyTestCaseTryCatch.png" width="520" height="514"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.14</a>:&nbsp;&nbsp;Try-catch nodes in each 'Test-case'</td><td class="captionglue"></td>
</tr>
</table>
                                    
<p>
                                            Our goal is to reduce the redundancy and to move the
                                            exception handling - which is always
                                            the same - to one global
                                            location. This location will be our 'Dependency'.
                                    </p>
                                    
<p>The first step is
                                            adding the 'Catch' node to the 'Dependency' via clicking at the
                                            closed 'Error handler' node and selecting &raquo;<em>Insert node</em>&laquo;-&raquo;<em>Control structures</em>&laquo;-&raquo;<em>Catch</em>&laquo; in the menu. Then we can copy the
                                            procedure-calls for stopping the SUT into that 'Catch'. Now the
                                            try-catch nodes in the single test-cases become unnecessary. Please
                                            move the procedure-calls out of the 'Try' and remove the
                                            empty try-catch structure.
                                    </p>
                                    
<p>
                                            Your test-suite should look like this now:
                                    </p>
                                    
<a name="fig_depCatchTestSuite"></a><a name="figure_29.15"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyWithException.png" target="_blank"><img texscale=".66" src="images/DependencyWithException.png" width="500" height="530"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.15</a>:&nbsp;&nbsp;Test-suite with 'Catch'</td><td class="captionglue"></td>
</tr>
</table>
                                    
<p>
                                            Now you can start the 'Test-set' 'Test with exception'. The second
                                            'Test-case' throws an
                                            IndexNotFoundException, because
                                            the selected vehicle does not exist.
                                            It is intended to handle that exception in the
                                            'Catch' of the
                                            'Dependency'.
  </p>
  
<p>
                                            
<span class="margin"><span class="note">Note</span></span> If the debugger is activated, QF-Test interrupts the test-run at the place
                                            where the exception arises. In this case you might have to re-throw
                                            the exception via the 'Rethrow
                                            exception' button. An alternative
                                            is to deactivate the debugger via
                                            &raquo;<em>Debugger</em>&laquo;-&raquo;<em>Enable debugger</em>&laquo;.
                                    </p>
                                    
<p>
                                            After the test-run you can open the run-log and verify what happened.
                                    </p>
                                    
<a name="fig_depRunLogCatchDep"></a><a name="figure_29.16"></a>
<table class="figure" cellspacing="0">
<tr>
<td class="margin">
<table class="margin"></table>
</td><td align="center" colspan="3"><a href="images/DependencyRunLogException.png" target="_blank"><img texscale=".66" src="images/DependencyRunLogException.png" width="404" height="178"></a></td>
</tr>
<tr>
<td class="margin">
<table class="margin"></table>
</td><td class="captionglue"></td><td class="caption"><a href="figures.html#list-of-figures">Figure&nbsp;29.16</a>:&nbsp;&nbsp;Run-log of a 'Dependency' with 'Catch'</td><td class="captionglue"></td>
</tr>
</table>
                                    
<p>In a normal project you should at least try to catch a
                                            'TestException' and the 'Catch' should contain a procedure call
                                            of either <code>qfs.swing.cleanup.closeAllModalDialogs</code>,
                                            <code>qfs.fx.cleanup.closeAllModalDialogs</code>
                                            or <code>qfs.swt.cleanup.closeAllModalDialogsAndModalShells</code>.
                                            Those procedures close all modal dialogs, e.g. dialog windows,
                                            which are blocking the execution.
                                    </p>
                            

                            
<a name="sec_depErrorCatchSum"></a>
                                    
<h5 class="header-container h5">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_depErrorCatchSum">29.4.3</a></span>
</div>
<a href="contents.html#toc_sec_depErrorCatchSum">Summary</a>
</h5>
                                    
<p>
                                            You have seen that you can implement a very strong recovery system
                                            for your test-cases using the 'Error handler' and, even more important,
                                            the 'Catch' of 'Dependencies'.
                                    </p>
                                    
<p>In most projects the global 'Catch' node becomes very important,
                                            especially if
                                            ComponentNotFoundExceptions and ModalDialogExceptions appear.
                                    </p>
                            
                    

    
    

    
<a name="sec_depMoreDep"></a>
      
<h4 class="header-container h4">
<div>
<span class="numtitle"><a href="contents.html#toc_sec_depMoreDep">29.5</a></span>
</div>
<a href="contents.html#toc_sec_depMoreDep">More about dependencies</a>
</h4>
      
<p>
        In the previous sections we have learned that we can combine several
        dependencies and that the 'Cleanup' of a 'Dependency' is only
        executed, if the stack of combined dependencies changes. We could also instruct a 'Dependency' to call its
        'Cleanup' every time after a 'Test-case'. This can be achieved
        by checking the attribute 'Forced cleanup' of the 'Dependency'.
      </p>
      
<p>
        There are even more interesting features about dependencies, e.g. you
        can use a variable instructing QF-Test to run the 'Cleanup'. This
        variable is called 'Characteristic variable'. You will find more
        details about that feature in the manual at chapter <a href="../../manual/en/dependencies.html#sec_dependencies" shape="rect">Dependencies</a>.
        This approach could be used to create one 'user login' 'Dependency' which
        will only run through its 'Cleanup', i.e. perform the logout, if
        another user is required by the next 'Test-case'.
      </p>
      
<p>
        A detailed description of dependencies can be found in the manual at
        chapter <a href="../../manual/en/dependencies.html#sec_dependencies" shape="rect">Dependencies</a>.
      </p>
    
    
  
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="navifooter">
<tr>
<td class="margin"></td><td class="navicon"><a href="tutorial.html"><img src="../icons/linktop.png" width="34" height="36" border="0" alt="Top" title="Top"></a></td><td class="navicon"><a href="contents.html#table-of-contents"><img src="../icons/linktoc.png" width="34" height="36" border="0" alt="Table of contents" title="Table of contents"></a></td><td class="navicon"><a href="datadriven.html#sec_DataDriven"><img src="../icons/linkprev.png" width="34" height="36" border="0" alt="Previous Chapter: 28&nbsp;Data driven Testing: Running one 'Test-case' with different test
    data" title="Previous Chapter: 28&nbsp;Data driven Testing: Running one 'Test-case' with different test
    data"></a></td><td class="navicon"><a href="tut_procbuilder.html#sec_AdvProcbuilder"><img src="../icons/linkcont.png" width="34" height="36" border="0" alt="Next Page: 30&nbsp;Automated creation of basic procedures" title="Next Page: 30&nbsp;Automated creation of basic procedures"></a></td><td class="navicon"><a href="tut_procbuilder.html#sec_AdvProcbuilder"><img src="../icons/linknext.png" width="34" height="36" border="0" alt="Next Chapter: 30&nbsp;Automated creation of basic procedures" title="Next Chapter: 30&nbsp;Automated creation of basic procedures"></a></td><td class="navicon"><a href="advanced.html#sec_advanced"><img src="../icons/linkup.png" width="34" height="36" border="0" alt="Chapter Overview: V&nbsp;Advanced features of QF-Test" title="Chapter Overview: V&nbsp;Advanced features of QF-Test"></a></td><td class="navicon"><a href="../../tutorial_en.pdf" target="_parent"><img src="../icons/linkpdf.png" width="34" height="36" border="0" alt="PDF version" title="PDF version"></a></td><td class="navcopymod">Last update: 9/6/2022<br>Copyright &copy; 2002-2022 Quality First Software GmbH</td>
</tr>
</table>
</body>
</html>
